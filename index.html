<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>æŠ½é¢˜ç³»ç»Ÿ</title>
</head>
<body>
  <h1>æŠ½é¢˜ç³»ç»Ÿ</h1>
  <input type="text" id="username" placeholder="è¯·è¾“å…¥ä½ çš„å§“å" />
  <button onclick="drawQuestion()">å¼€å§‹æŠ½é¢˜</button>
  <div id="result" style="margin-top: 20px;"></div>

  <script>
    // 100é“é¢˜ç›®ï¼ˆä½ å¯ä»¥ç»§ç»­è¡¥å……ï¼‰
    const questionPool = [
      {
        label: 'A',
        content: 'ä¿¡ç”¨å¡æ­£å¸¸æ¶ˆè´¹æœ‰20-50å¤©çš„å…æ¯æœŸã€‚å¦‚æœåœ¨å…æ¯æœŸè¿˜å¤Ÿå…¨é¢è´¦å•å°±æ²¡æœ‰åˆ©æ¯ã€‚ä¿¡ç”¨å¡æŒ‰å¤®è¡Œã€Šé“¶è¡Œå¡ä¸šåŠ¡ç®¡ç†åŠæ³•ã€‹æ”¶å–åˆ©æ¯ï¼Œåˆ©æ¯æ˜¯æ¯æ—¥0.05%ï¼Œä¹Ÿå°±æ˜¯å¹´æ¯18.25%ã€‚'
      },
      {
        label: 'B',
        content: 'é¢˜ç›®2çš„è¯¦ç»†å†…å®¹'
      },
      {
        label: 'C',
        content: 'é¢˜ç›®3çš„è¯¦ç»†å†…å®¹'
      },
      // å¯è¡¥è¶³è‡³ 100 é“
    ];

    async function drawQuestion() {
      const username = document.getElementById('username').value.trim();
      const resultBox = document.getElementById('result');

      if (!username) {
        alert('è¯·è¾“å…¥ä½ çš„å§“åï¼');
        return;
      }

      const index = Math.floor(Math.random() * questionPool.length);
      const question = questionPool[index];

      resultBox.innerHTML = `<strong>${username}</strong> æŠ½åˆ°äº†é¢˜ç›® ${index + 1}ï¼ˆ${question.label}ï¼‰ï¼š<br>${question.content}`;

      try {
        const response = await fetch('http://localhost:3000/api/record', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            username: username,
            questionIndex: index,
            questionText: question.content,
            timestamp: new Date().toISOString()
          })
        });

        const result = await response.json();

        if (response.status === 403) {
          alert('âš ï¸ æŠ±æ­‰ï¼Œä½ å·²ç»è¾¾åˆ°æœ€å¤§æŠ½é¢˜æ¬¡æ•°ï¼ˆ5æ¬¡ï¼‰');
        }
      } catch (err) {
        alert('ğŸš« æ— æ³•è¿æ¥æœåŠ¡å™¨ï¼Œè¯·ç¡®è®¤åç«¯å·²å¯åŠ¨');
        console.error(err);
      }
    }
  </script>
</body>
</html>
